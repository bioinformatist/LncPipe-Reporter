---
title: "MultiIP Reports"
author: "Yu Sun"
date: "June 26, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.width = 4.5, fig.height = 3)
```

## Plot 1: Scatter plot -- `CPAT` against `CDF`

```{r echo = FALSE, message = FALSE}
require(plotly)
require(data.table)
require(cowplot)
cdf <- fread('CDF.txt')
cdf <- cdf[ order(cdf[,1], cdf[,2]) ]
# cdf <- cdf[sample(nrow(cdf), 50000), ]
names(cdf) <- c('Type', 'CPAT')
p <- ggplot() + geom_step(data = cdf, aes(x = CPAT, colour = Type), size = 2, stat = 'ecdf') + scale_x_continuous(expand  = c(0,0)) + scale_y_continuous(expand = c(0, 0)) + labs(x = 'Coding Probablity(CPAT)', title = "Coding Potential", y = "CDF") + scale_color_manual(values = c("#FFA500", "#3A5FCD", "#EE2C2C")) + geom_hline(yintercept = 1, colour = "grey",linetype = "dashed",size = 1)
ggplotly(p)
# p
```

## Plot 2: Density plot -- `Transcript length` against `Density`

```{r echo = FALSE, message = FALSE}
# cdf <- cdf[,1:2]
# cdf$value <- cdf$value * 50000
# cdf <- cdf[sample(nrow(cdf), 500), ]
# p <- ggplot() + geom_density(data = cdf, aes(x = value, colour = type)) + xlab('Transcript length') + ylab('Density') + scale_x_continuous(expand = c(0.01, 0)) + scale_y_continuous(expand = c(0.01, 0))
# ggplotly(p)
```


